[2025-09-12] Source URL: https://developers.google.com/workspace/calendar/api/guides/version-resources

이 페이지는 Cloud Translation API [https://cloud.google.com/translate/?hl=ko]를 통해 번역되었습니다.
Switch to English
홈 [https://developers.google.com/?hl=ko]
Google Workspace [https://developers.google.com/workspace?hl=ko]
Google Calendar [https://developers.google.com/workspace/calendar?hl=ko]
가이드 [https://developers.google.com/workspace/calendar/api/guides/overview?hl=ko]
의견 보내기
특정 버전의 리소스 가져오기
bookmark_border
이 페이지의 내용
조건부 수정 [https://developers.google.com/workspace/calendar/api/guides/version-resources?hl=ko#conditional_modification]
조건부 검색 [https://developers.google.com/workspace/calendar/api/guides/version-resources?hl=ko#conditional_retrieval]
모든 리소스에는 리소스가 변경될 때마다 변경되는 버전 필드(etag 필드)가 있습니다. ETag는 HTTP의 표준 부분이며 다음과 같은 두 가지 경우에 캘린더 API에서 지원됩니다.
리소스 수정 시 그동안 이 리소스에 다른 쓰기가 없었는지 확인합니다 (조건부 수정).
리소스가 변경된 경우에만 리소스 데이터를 가져오기 위해 리소스 검색 시
조건부 수정
마지막으로 검색한 이후 변경되지 않은 경우에만 리소스를 업데이트하거나 삭제하려면 이전 검색의 etag 값을 포함하는 If-Match 헤더를 지정하면 됩니다. 이는 리소스의 수정사항이 손실되는 것을 방지하는 데 매우 유용합니다. 클라이언트는 리소스를 다시 가져오고 변경사항을 다시 적용할 수 있습니다.
마지막 검색 이후 항목 (및 해당 ETag)이 변경되지 않은 경우 수정이 성공하고 새 ETag가 있는 리소스의 새 버전이 반환됩니다. 그렇지 않으면 412 (전제 조건 실패) 응답 코드가 표시됩니다.
중요: 삽입 작업의 조건부 수정은 지원되지 않습니다. 대신 리소스 ID를 제공할 수 있는 경우 기존 항목에 해당 ID가 없는 경우에만 작업이 성공합니다.
아래 샘플 코드 스니펫은 Java 클라이언트 라이브러리 [https://developers.google.com/api-client-library/java/apis/calendar/v3?hl=ko]를 사용하여 조건부 수정을 실행하는 방법을 보여줍니다.
  private static void run() throws IOException {
    // Create a test event.
    Event event = Utils.createTestEvent(client, "Test Event");
    System.out.println(String.format("Event created: %s", event.getHtmlLink()));

    // Pause while the user modifies the event in the Calendar UI.
    System.out.println("Modify the event's description and hit enter to continue.");
    System.in.read();

    // Modify the local copy of the event.
    event.setSummary("Updated Test Event");

    // Update the event, making sure that we don't overwrite other changes.
    int numAttempts = 0;
    boolean isUpdated = false;
    do {
      Calendar.Events.Update request = client.events().update("primary", event.getId(), event);
      request.setRequestHeaders(new HttpHeaders().setIfMatch(event.getEtag()));
      try {
        event = request.execute();
        isUpdated = true;
      } catch (GoogleJsonResponseException e) {
        if (e.getStatusCode() == 412) {
          // A 412 status code, "Precondition failed", indicates that the etag values didn't
          // match, and the event was updated on the server since we last retrieved it. Use
          // {@link Calendar.Events.Get} to retrieve the latest version.
          Event latestEvent = client.events().get("primary", event.getId()).execute();

          // You may want to have more complex logic here to resolve conflicts. In this sample we're
          // simply overwriting the summary.
          latestEvent.setSummary(event.getSummary());
          event = latestEvent;
        } else {
          throw e;
        }
      }
      numAttempts++;
    } while (!isUpdated && numAttempts <= MAX_UPDATE_ATTEMPTS);

    if (isUpdated) {
      System.out.println("Event updated.");
    } else {
      System.out.println(String.format("Failed to update event after %d attempts.", numAttempts));
    }
  }
ConditionalModificationSample.java [https://github.com/googleworkspace/java-samples/blob/b30298095f654ff9952a691333f0aa5862ab935c/calendar/sync/src/main/java/com/google/api/services/samples/calendar/sync/ConditionalModificationSample.java]
조건부 검색
마지막으로 검색한 이후에 변경된 경우에만 리소스를 검색하려면 이전 검색의 etag 값을 포함하는 If-None-Match 헤더를 지정하면 됩니다. 마지막으로 검색한 이후 항목 (따라서 etag)이 변경된 경우 새 etag가 있는 리소스의 새 버전이 반환됩니다. 그렇지 않으면 304 (수정되지 않음) 응답 코드가 표시됩니다.
참고: calendarList 항목의 읽기 전용 필드 중 하나가 변경되는 경우 (예: 캘린더 속성 또는 ACL)와 같이 etag가 변경되지 않는 특수한 경우가 있습니다.
아래 샘플 코드 스니펫은 Java 클라이언트 라이브러리 [https://developers.google.com/api-client-library/java/apis/calendar/v3?hl=ko]를 사용하여 조건부 검색을 실행하는 방법을 보여줍니다.
  private static void run() throws IOException {
    // Create a test event.
    Event event = Utils.createTestEvent(client, "Test Event");
    System.out.println(String.format("Event created: %s", event.getHtmlLink()));

    // Pause while the user modifies the event in the Calendar UI.
    System.out.println("Modify the event's description and hit enter to continue.");
    System.in.read();

    // Fetch the event again if it's been modified.
    Calendar.Events.Get getRequest = client.events().get("primary", event.getId());
    getRequest.setRequestHeaders(new HttpHeaders().setIfNoneMatch(event.getEtag()));
    try {
      event = getRequest.execute();
      System.out.println("The event was modified, retrieved latest version.");
    } catch (GoogleJsonResponseException e) {
      if (e.getStatusCode() == 304) {
        // A 304 status code, "Not modified", indicates that the etags match, and the event has
        // not been modified since we last retrieved it.
        System.out.println("The event was not modified, using local version.");
      } else {
        throw e;
      }
    }
  }
ConditionalRetrievalSample.java [https://github.com/googleworkspace/java-samples/blob/b30298095f654ff9952a691333f0aa5862ab935c/calendar/sync/src/main/java/com/google/api/services/samples/calendar/sync/ConditionalRetrievalSample.java]
의견 보내기