Source URL: https://developers.google.com/workspace/gmail/ampemail/authenticating-requests

이 페이지는 Cloud Translation API [https://cloud.google.com/translate/?hl=ko]를 통해 번역되었습니다.
Switch to English
홈 [https://developers.google.com/?hl=ko]
Google Workspace [https://developers.google.com/workspace?hl=ko]
Gmail [https://developers.google.com/workspace/gmail?hl=ko]
가이드 [https://developers.google.com/workspace/gmail/api/guides?hl=ko]
의견 보내기
이메일용 AMP에서 요청 인증
bookmark_border
이 페이지의 내용
액세스 토큰
예
동적으로 맞춤설정된 이메일 콘텐츠에는 사용자 인증이 필요한 경우가 많습니다. 하지만 사용자 데이터를 보호하기 위해 Gmail 내 AMP 이메일 내에서 이루어진 모든 HTTP 요청은 프록시되고 쿠키가 삭제됩니다.
AMP 이메일에서 이루어진 요청을 인증하려면 액세스 토큰 [https://developers.google.com/workspace/gmail/ampemail/authenticating-requests?hl=ko#access_tokens]을 사용하면 됩니다.
액세스 토큰
액세스 토큰을 사용하여 사용자를 인증할 수 있습니다. 액세스 토큰은 이메일 발신자가 제공하고 확인합니다. 발신자는 토큰을 사용하여 AMP 이메일에 액세스할 수 있는 사용자만 이메일에 포함된 요청을 할 수 있도록 합니다. 액세스 토큰은 암호화로 보호되어야 하며 시간 및 범위가 제한되어야 합니다. 요청의 URL 내에 포함되어 있습니다.
이 예에서는 <amp-list>를 사용하여 인증된 데이터를 표시하는 방법을 보여줍니다.
<amp-list src="https://example.com/endpoint?token=REPLACE_WITH_YOUR_ACCESS_TOKEN"
  height="300">
  <template type="amp-mustache">
    ...
  </template>
</amp-list>
마찬가지로 <amp-form>를 사용할 때는 액세스 토큰을 action-xhr URL에 배치합니다.
<form action-xhr="https://example.com/endpoint?token=REPLACE_WITH_YOUR_ACCESS_TOKEN" method="post">
  <input type="text" name="data">
  <input type="submit" value="Send">
</form>
참고: 이메일 클라이언트는 일반적으로 답장/전달 시 AMP MIME 부분을 삭제합니다.

또한 Gmail은 AMP 부분이 수신된 후 30일 동안만 사용할 수 있다고 간주하므로 액세스 토큰의 전체 기간은 31일로 설정해야 합니다.
예
다음 예에서는 로그인한 사용자가 계정에 메모를 추가하고 나중에 볼 수 있는 가상의 메모 작성 서비스를 고려합니다. 서비스는 사용자가 이전에 작성한 메모 목록이 포함된 이메일을 사용자 jane@example.com에게 보내려고 합니다. 현재 사용자의 메모 목록은 엔드포인트 https://example.com/personal-notes에서 JSON 형식으로 확인할 수 있습니다.
이메일을 보내기 전에 서비스는 jane@example.com: A3a4roX9x용으로 암호화 방식으로 안전한 사용 빈도가 제한된 액세스 토큰을 생성합니다. 액세스 토큰은 URL 쿼리 내의 필드 이름 exampletoken에 포함됩니다.
<amp-list src="https://example.com/personal-notes?exampletoken=A3a4roX9x" height="300">
  <template type="amp-mustache">
    <p>{{note}}</p>
  </template>
</amp-list>
엔드포인트 https://example.com/personal-notes는 exampletoken 매개변수를 확인하고 토큰과 연결된 사용자를 찾는 일을 담당합니다.
자세한 내용은 제한된 사용 액세스 토큰 [https://developers.google.com/workspace/gmail/markup/actions/limited-use-access-tokens?hl=ko]을 참고하세요.
참고: 기존 웹 애플리케이션은 XMLHttpRequest (XHR)로 사용자 메모 엔드포인트를 쿼리할 수 있으며 쿠키는 엔드포인트에 사용자 ID를 제공할 수 있습니다. 하지만 이메일용 AMP에서는 모든 HTTP 요청이 Gmail AMP 이메일에서 익명처리되므로 이 접근 방식이 작동하지 않습니다. 대신 AMP는 URL 자체에서 사용자를 식별해야 합니다.
의견 보내기